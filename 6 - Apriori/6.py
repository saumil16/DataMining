# -*- coding: utf-8 -*-
"""DataMining_Lab6_InbuiltLibrary.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1pmfWieiLsN4ajFJlpmzIP4JyTTTOuNKf
"""

import pandas as pd
from mlxtend.preprocessing import TransactionEncoder
from mlxtend.frequent_patterns import apriori, association_rules

df = pd.read_csv('/content/Market_Basket_Optimisation.csv',sep=',',header=None)
df.fillna("", inplace=True)
df.head()

items = set()
for col in df:
    unique_values = df[col].unique()
    for val in unique_values:
        if val != "":
            items.add(val)

print(items)

itemset = set(items)
encoded_vals = []
for index, row in df.iterrows():
    rowset = set(row)
    labels = {}
    uncommons = list(itemset - rowset)
    commons = list(itemset.intersection(rowset))
    for uc in uncommons:
        labels[uc] = 0
    for com in commons:
        labels[com] = 1
    encoded_vals.append(labels)
encoded_vals[0]
ohe_df = pd.DataFrame(encoded_vals)

sp = apriori(ohe_df, min_support=0.02, use_colnames=True)
sp

association_rules(sp,metric="confidence",min_threshold=0.1)